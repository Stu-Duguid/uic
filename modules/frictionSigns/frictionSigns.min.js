TLT.addModule("frictionSigns",function(t){"use strict";function e(t,e){for(var i=0;i<e.length;i++)if("string"==typeof e[i]?-1!=t.indexOf(e[i]):t.match(e[i]))return!0;return!1}function i(t){v=p.rageclick||{enable:!0},v.enable&&(v.clicks=v.clicks||4,v.distance=v.distance||20,v.time=v.time||800,v.blocklist=v.blocklist||[],v.count=0,v.lastTime=0,m=!0)}function n(i){if("unload"!==i.type){if(!e(v.blocklist,i.target.id)){if(0===v.count||Math.abs(i.position.x-v.x)>v.distance||Math.abs(i.position.y-v.y)>v.distance||i.timestamp-v.lastTime>v.time)return v.x=i.position.x,v.y=i.position.y,v.count=1,void(v.lastTime=i.timestamp);v.count++,v.x=i.position.x,v.y=i.position.y,v.count===v.clicks&&(t.post({type:5,customEvent:{name:"rageclick",data:{description:"Rage click - "+i.target.id,value:{target:i.target.id}}}}),v.count=0)}}else v.count=0}function o(t){g=p.deadclick||{enable:!0},g.enable&&(g.time=g.time||2e3,g.blocklist=g.blocklist||[],m=!0)}function a(i){if("click"===i.type){if("input"===i.target.type&&"button"!==i.target.subType||"select"===i.target.type||"label"===i.target.type)return;if("a"===i.target.type&&"_blank"===i.target.target)return;if(e(g.blocklist,i.target.id))return;var n=!0,o=i.target.id,a=new MutationObserver(function(){n=!1,a.disconnect()});return a.observe(document.body,{subtree:!0,childList:!0,attributeFilter:["style","class"]}),void setTimeout(function(){n&&t.post({type:5,customEvent:{name:"deadclick",data:{description:"Dead click - "+o,value:{target:o}}}})},g.time)}}function s(t){f=p.errorclick||{enable:!0},f.enable&&(f.time=f.time||200,f.blocklist=f.blocklist||[],f.target=null,f.clickTime=0,m=!0)}function l(i){if("click"===i.type)return f.target=i.target.id,void(f.clickTime=i.timestamp);if("error"!==i.type)"unload"===i.type&&(f.target=null);else{if(e(f.blocklist,i.target.id))return;if(f.target&&i.nativeEvent.message){if(i.timestamp-f.clickTime<f.time)return void t.post({type:5,customEvent:{name:"errorclick",data:{description:"Error click - "+f.target,value:{target:f.target,url:i.nativeEvent.filename,line:i.nativeEvent.lineno,description:i.nativeEvent.message}}}});f.target=null}}}function c(t){y=p.excessscroll||{enable:!0},y.enable&&(y.scale=y.scale||2.4,y.blocklist=y.blocklist||[],y.distance=0,y.lastpos=0,m=!0)}function r(i){if(!e(y.blocklist,i.target.id))return"scroll"===i.type?(y.distance+=Math.abs(window.scrollY-y.lastpos),y.lastpos=window.scrollY,void(0!==document.body.scrollHeight&&y.distance>document.body.scrollHeight*y.scale&&(t.post({type:5,customEvent:{name:"excessscroll",data:{description:"Excess scrolling",value:{distance:y.distance,pageheight:document.body.scrollHeight,viewport:window.visualViewport&&window.visualViewport.height?window.visualViewport.height:0}}}}),y.distance=0))):"orientationchange"===i.type?(y.distance=window.scrollY,void(y.lastpos=window.scrollY)):void("unload"===i.type&&(y.distance=0,y.lastpos=0))}function d(t){b=p.thrashing||{enable:!0},b.enable&&(b.time=b.time||4e3,b.blocklist=b.blocklist||[],b.threshold=10*Math.PI,b.moves=0,b.x=0,b.y=0,b.lastDirection=0,b.total=0,b.seen=[],m=!0)}function u(i){if(!e(y.blocklist,i.target.id))if("mousemove"!==i.type)"unload"===i.type&&(b.seen=[],b.total=0,b.moves=0,b.x=0,b.y=0);else{if(b.x+=i.nativeEvent.movementX,b.y+=i.nativeEvent.movementY,b.moves++,b.moves<10)return;var n=Math.atan2(b.y,b.x);b.moves=0,b.x=0,b.y=0;var o=b.seen.length>0?Math.abs((n-b.lastDirection)%Math.PI):0;for(b.lastDirection=n,b.total+=o,b.seen.push({time:i.timestamp,delta:o});b.seen.length>1&&i.timestamp-b.seen[0].time>b.time;)b.total-=b.seen[0].delta,b.seen.shift();b.total>b.threshold&&(t.post({type:5,customEvent:{name:"thrashing",data:{description:"Thrashing pointer",value:{amount:b.total}}}}),b.seen=[],b.total=0)}}var m,p,v,g,f,y,b;return{init:function(){m=!1,p=t.getConfig(),i(),o(),s(),c(),d()},destroy:function(){m=!1},onevent:function(t){if("object"==typeof t&&t.type&&m){if("click"===t.type)return n(t),a(t),void l(t);if("error"!==t.type)if("scroll"!==t.type&&"orientationchange"!==t.type){if("mousemove"!==t.type)return"unload"===t.type?(n(t),a(t),l(t),r(t),void u(t)):void 0;u(t)}else r(t);else l(t)}},version:"1.0"}});